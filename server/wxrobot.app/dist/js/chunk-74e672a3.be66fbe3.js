(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74e672a3"],{"1ac0":function(e,t,n){"use strict";var s=n("2cee"),a=n.n(s);a.a},"2cee":function(e,t,n){},"32a6":function(e,t,n){var s=n("241e"),a=n("c3a1");n("ce7e")("keys",function(){return function(e){return a(s(e))}})},"386d":function(e,t,n){"use strict";var s=n("cb7c"),a=n("83a1"),i=n("5f1b");n("214f")("search",1,function(e,t,n,o){return[function(n){var s=e(this),a=void 0==n?void 0:n[t];return void 0!==a?a.call(n,s):new RegExp(n)[t](String(s))},function(e){var t=o(n,e,this);if(t.done)return t.value;var c=s(e),l=String(this),r=c.lastIndex;a(r,0)||(c.lastIndex=0);var u=i(c,l);return a(c.lastIndex,r)||(c.lastIndex=r),null===u?-1:u.index}]})},"454f":function(e,t,n){n("46a7");var s=n("584a").Object;e.exports=function(e,t,n){return s.defineProperty(e,t,n)}},"46a7":function(e,t,n){var s=n("63b6");s(s.S+s.F*!n("8e60"),"Object",{defineProperty:n("d9f6").f})},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"85f2":function(e,t,n){e.exports=n("454f")},"8aae":function(e,t,n){n("32a6"),e.exports=n("584a").Object.keys},a4bb:function(e,t,n){e.exports=n("8aae")},ce7e:function(e,t,n){var s=n("63b6"),a=n("584a"),i=n("294c");e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],o={};o[e]=t(n),s(s.S+s.F*i(function(){n(1)}),"Object",o)}},dc5d:function(e,t,n){"use strict";var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("van-nav-bar",{attrs:{title:e.$route.meta.title,"left-text":"返回","left-arrow":""},on:{"click-left":e.goback}})},a=[],i={name:"topNav",data:function(){return{}},methods:{goback:function(){this.$router.go(-1)}}},o=i,c=n("2877"),l=Object(c["a"])(o,s,a,!1,null,"2fe8c154",null);t["a"]=l.exports},e8d8:function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("van-nav-bar",{attrs:{title:e.$route.meta.title,"left-text":"返回","left-arrow":""},on:{"click-left":e.goback}},[n("van-icon",{attrs:{slot:"right",name:"add-o",size:"18px"},on:{click:function(t){e.addPopup=!0}},slot:"right"})],1),n("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:function(e){}},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.msgs,function(t){return n("van-swipe-cell",{attrs:{"right-width":65}},[n("van-cell-group",[n("van-cell",{attrs:{value:e.getContentTypeDesc(t.type),icon:"clock-o"},on:{click:function(n){return e.showContent(t)}}},[n("template",{slot:"title"},[n("span",{staticClass:"custom-text timer_type_desc"},[e._v(e._s(e.getTimerTypeDesc(t.schedule)))]),n("span",{staticClass:"custom-text",staticStyle:{"white-space":"nowrap"}},[e._v("["+e._s(e.formatTime(t.schedule))+"]")])])],2)],1),n("span",{attrs:{slot:"right"},on:{click:function(n){return e.delDialog(t.uuid)}},slot:"right"},[e._v("删除")])],1)}),1),n("van-popup",{staticStyle:{width:"100%",height:"100%"},attrs:{position:"right",overlay:!1},model:{value:e.addPopup,callback:function(t){e.addPopup=t},expression:"addPopup"}},[n("van-nav-bar",{attrs:{title:"添加分群定时消息","left-text":"返回","left-arrow":""},on:{"click-left":function(t){e.addPopup=!1}}}),n("van-radio-group",{model:{value:e.timeRadio,callback:function(t){e.timeRadio=t},expression:"timeRadio"}},[n("van-cell-group",{attrs:{title:"时间类型"}},[n("van-cell",{attrs:{title:"间隔时间",clickable:""},on:{click:function(t){e.timeRadio="1"}}},[n("van-radio",{attrs:{name:"1"}})],1),n("van-cell",{attrs:{title:"固定时间",clickable:""},on:{click:function(t){e.timeRadio="2"}}},[n("van-radio",{attrs:{name:"2"}})],1)],1)],1),n("van-cell-group",{directives:[{name:"show",rawName:"v-show",value:"1"==e.timeRadio,expression:"timeRadio=='1'"}]},[n("van-field",{attrs:{label:"间隔时间","left-icon":"clock-o",readonly:"readonly",clearable:"",placeholder:"请输入时间数值，单位：秒"},on:{focus:function(t){e.show=!0}},model:{value:e.schedule.ss,callback:function(t){e.$set(e.schedule,"ss",t)},expression:"schedule.ss"}}),n("p",{staticClass:"timer_desc"},[e._v("\r\n            频率每隔：["+e._s(parseInt(e.schedule.ss/60/60%60)+"小时"+parseInt(e.schedule.ss/60%60)+"分钟"+parseInt(e.schedule.ss%60)+"秒")+"]  发送一次\r\n            ")])],1),n("van-cell-group",{directives:[{name:"show",rawName:"v-show",value:"2"==e.timeRadio,expression:"timeRadio=='2'"}]},[n("span",{staticClass:"timer_desc"},[e._v("\r\n                    每当时间到达：[\r\n                "),n("span",{directives:[{name:"show",rawName:"v-show",value:null!=e.schedule.MM,expression:"schedule.MM != null"}]},[e._v(e._s(e.schedule.MM)+"月")]),n("span",{directives:[{name:"show",rawName:"v-show",value:null!=e.schedule.dd,expression:"schedule.dd != null"}]},[e._v(e._s(e.schedule.dd)+"日")]),n("span",{directives:[{name:"show",rawName:"v-show",value:null!=e.schedule.HH,expression:"schedule.HH != null"}]},[e._v(e._s(e.schedule.HH)+"时")]),n("span",{directives:[{name:"show",rawName:"v-show",value:null!=e.schedule.mm,expression:"schedule.mm != null"}]},[e._v(e._s(e.schedule.mm)+"分")]),n("span",{directives:[{name:"show",rawName:"v-show",value:""!=e.schedule.ss,expression:"schedule.ss != ''"}]},[e._v(e._s(e.schedule.ss)+"秒")]),e._v("] 发送一次\r\n            ")]),n("p",{staticClass:"p_timer_desc"},[e._v('"*" 号为该区域内所有时间段，例："14时5分*秒" 在下午2点5分 每秒发送一次')])]),n("van-radio-group",{model:{value:e.contentRadio,callback:function(t){e.contentRadio=t},expression:"contentRadio"}},[n("van-cell-group",{attrs:{title:"消息内容"}},[n("van-cell",{attrs:{title:"文本",clickable:""},on:{click:function(t){e.contentRadio="1"}}},[n("van-radio",{attrs:{name:"1"}})],1),n("van-cell",{attrs:{title:"文件",clickable:""},on:{click:function(t){e.contentRadio="2"}}},[n("van-radio",{attrs:{name:"2"}})],1)],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"1"==e.contentRadio,expression:"contentRadio=='1'"}],staticStyle:{"margin-bottom":"10px","max-height":"600px",overflow:"hidden"}},[n("van-field",{attrs:{type:"textarea",autosize:{maxHeight:200,minHeight:150},clearable:"",placeholder:"请输入内容..."},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"2"==e.contentRadio,expression:"contentRadio=='2'"}],staticClass:"uploader",attrs:{onclick:"document.getElementById('hiddenFile').click();"}},[n("div",{staticClass:"ivu-icon"},[n("van-icon",{attrs:{name:"upgrade"}}),n("input",{ref:"uploader",staticStyle:{display:"none"},attrs:{multiple:"multiple",type:"file",id:"hiddenFile"},on:{change:e.onRead}})],1),n("p",{staticStyle:{color:"rgb(51, 153, 255)"}},[e._v("点击上传文件")])]),e.imageVal&&"2"==e.contentRadio?n("div",{on:{click:e.showImg}},[n("van-icon",{staticClass:"img_icon",attrs:{name:"photo-o",size:"35px"}}),n("span",{staticClass:"custom-text",staticStyle:{display:"inline-block","padding-left":"5px"}},[e._v("\r\n                点击查看图片详情\r\n            ")])],1):"2"==e.contentRadio?n("span",{staticClass:"custom-text file_txt"},[e._v(e._s(e.contentFileName))]):e._e(),n("van-button",{attrs:{size:"large",type:"info",loading:e.loading},on:{click:e.addTimerMsg}},[e._v("\r\n            确定提交\r\n        ")]),n("van-popup",{attrs:{position:"bottom"},model:{value:e.pickerPopup,callback:function(t){e.pickerPopup=t},expression:"pickerPopup"}},[n("van-picker",{attrs:{"show-toolbar":"",title:"选择时间",columns:e.columns},on:{change:e.onChange,cancel:function(t){e.pickerPopup=!1},confirm:function(t){e.pickerPopup=!1}}})],1),n("van-number-keyboard",{attrs:{show:e.show,theme:"custom","close-button-text":"完成"},on:{blur:function(t){e.show=!1},input:e.onInput,delete:e.onDelete}})],1),n("van-dialog",{attrs:{"show-cancel-button":"",beforeClose:e.beforeClose},model:{value:e.isShow,callback:function(t){e.isShow=t},expression:"isShow"}},[n("div",{staticClass:"van-dialog__content"},[n("div",{staticClass:"van-dialog__message"},[e._v("确定删除吗？")])])]),n("footerNav")],1)},a=[],i=(n("ac6a"),n("a4bb")),o=n.n(i),c=(n("386d"),n("7f7f"),n("28a5"),n("e814")),l=n.n(c),r=n("85f2"),u=n.n(r);function d(e,t,n){return t in e?u()(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}for(var h=n("dc5d"),p=n("5b59"),f=n("b970"),v=n("c276"),m=["*"],g=["*"],w=["*"],b=["*"],k=["*"],x=1;x<=12;x++)m.push(x);for(x=1;x<=31;x++)g.push(x);for(x=0;x<24;x++)w.push(x);for(x=0;x<60;x++)b.push(x);for(x=0;x<60;x++)k.push(x);var _={"月":m},R={"日":g},y={"时":w},j={"分":b},C={"秒":k},M={components:{topNav:h["a"],footerNav:p["a"]},data:function(){return d({token:"",seq:"",uuid:"",isShow:!1,addPopup:!1,loading:!1,finished:!0,msgs:[],columns:[{values:_["月"]},{values:R["日"]},{values:y["时"]},{values:j["分"]},{values:C["秒"]}],nowMM:"*",schedule:{MM:null,dd:null,HH:null,mm:null,ss:""},show:!1,timeRadio:"1",pickerPopup:!1,contentRadio:"1",content:null,contentFile:{},contentFileName:"",imageVal:null},"loading",!1)},watch:{timeRadio:function(e){this.pickerPopup=2==e}},mounted:function(){this.seq=Object(v["c"])(window.location.href).seq,this.token=Object(v["c"])(window.location.href).token_m,this.loadTimer()},methods:{showContent:function(e){var t="时间类型："+this.getTimerTypeDesc(e.schedule)+"\n时间设定："+this.formatTime(e.schedule)+"\n内容类型："+this.getContentTypeDesc(e.type)+"\n内容详情："+e.content;Object(f["e"])(t)},onChange:function(e,t,n){if(this.schedule.MM=t[0],this.schedule.dd=t[1],this.schedule.HH=t[2],this.schedule.mm=t[3],this.schedule.ss=t[4],0==n){var s=t[0];if(s==this.nowMM)return;this.nowMM=s;var a=["*"];if("*"==s)for(var i=1;i<=31;i++)a.push(i);else{var o=new Date(2019,l()(s),0).getDate();for(i=1;i<=o;i++)a.push(i)}R={"日":a};var c=[{values:_["月"]},{values:R["日"]},{values:y["时"]},{values:j["分"]},{values:C["秒"]}];this.columns=c}},onInput:function(e){this.schedule.ss=this.schedule.ss+""+e},onDelete:function(){this.schedule.ss=this.schedule.ss.substr(0,this.schedule.ss.length-1)},goback:function(){this.$router.go(-1)},getContentTypeDesc:function(e){return Object(v["b"])(e)},formatTime:function(e){var t=e.split("|"),n=t[0];if("1"==n){var s=t[1].split(",");return s[0]+"月"+s[1]+"日"+s[2]+"点"+s[3]+"分"+s[4]+"秒"}return l()(l()(t[1])/60/60%60)+"小时"+l()(l()(t[1])/60%60)+"分钟"+l()(l()(t[1])%60)+"秒"},getTimerTypeDesc:function(e){var t=e.split("|"),n=t[0];return"1"==n?"定时":"间隔"},showImg:function(){Object(f["b"])([""+this.imageVal])},onRead:function(e){var t=this.$refs.uploader,n=t.files[0];if(void 0!=n){this.imageVal=null;var s=Math.floor(n.size/1024);if(s>81920)return Object(f["e"])("请选择80M以内的文件！"),!1;if(this.contentFile=n,this.content=n.name,this.contentFileName=n.name,-1!=n.type.search("image/")){var a=this;if(!e||!window.FileReader)return;var i=new FileReader;i.readAsDataURL(n),i.onloadend=function(){a.imageVal=this.result}}}},loadTimer:function(){var e=this,t={seq:this.seq,token:this.token};this.$http.post("timer/getTimers?format=json",t).then(function(t){var n=t.data;console.log(n),n.result?f["e"].fail(n.msg):o()(n.data).length>0&&(e.msgs=n.data.info[e.seq])}).catch(function(e){console.log(e)})},delDialog:function(e){this.uuid=e,this.isShow=!0},beforeClose:function(e,t){var n=this;if("cancel"==e&&t(),"confirm"==e){var s={seq:this.seq,uuid:this.uuid,token:this.token};this.$http.post("timer/delMsg?format=json",s).then(function(e){t(),Object(f["e"])(e.data.msg),n.msgs=n.msgs.filter(function(e){return e.uuid!=n.uuid})}).catch(function(e){console.log(e)})}},addTimerMsg:function(){var e=this,t=new FormData;t.append("token",this.token),t.append("seq",this.seq),t.append("content","1"==this.contentRadio?this.content:this.contentFile);var n=[];if("2"==this.timeRadio){if(o()(this.schedule).forEach(function(t){n.push(e.schedule[t])}),n="1|"+n.join(","),-1!=n.indexOf(",,"))return void Object(f["e"])("时间信息不完整!")}else{if(""==this.schedule.ss)return void Object(f["e"])("时间信息不完整");n="2|"+this.schedule.ss}t.append("schedule",n),this.loading=!0,this.$http.post("timer/addMsg?format=json",t).then(function(t){var n=t.data;n.result?(e.loading=!1,f["e"].fail(n.msg)):(e.msgs.push(n.data.info),e.loading=!1,f["e"].success(n.msg),setTimeout(function(){e.addPopup=!1},500))}).catch(function(t){e.loading=!1,console.log(t)})}}},O=M,T=(n("1ac0"),n("2877")),N=Object(T["a"])(O,s,a,!1,null,null,null);t["default"]=N.exports}}]);
//# sourceMappingURL=chunk-74e672a3.be66fbe3.js.map