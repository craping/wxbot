(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-be45098a"],{"32a6":function(e,t,n){var s=n("241e"),a=n("c3a1");n("ce7e")("keys",function(){return function(e){return a(s(e))}})},"386d":function(e,t,n){"use strict";var s=n("cb7c"),a=n("83a1"),i=n("5f1b");n("214f")("search",1,function(e,t,n,o){return[function(n){var s=e(this),a=void 0==n?void 0:n[t];return void 0!==a?a.call(n,s):new RegExp(n)[t](String(s))},function(e){var t=o(n,e,this);if(t.done)return t.value;var l=s(e),c=String(this),r=l.lastIndex;a(r,0)||(l.lastIndex=0);var u=i(l,c);return a(l.lastIndex,r)||(l.lastIndex=r),null===u?-1:u.index}]})},"6a6a":function(e,t,n){},"6b5f":function(e,t,n){"use strict";var s=n("6a6a"),a=n.n(s);a.a},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"8aae":function(e,t,n){n("32a6"),e.exports=n("584a").Object.keys},a4bb:function(e,t,n){e.exports=n("8aae")},be84:function(e,t,n){"use strict";n.r(t);for(var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("van-nav-bar",{attrs:{title:e.$route.meta.title,"left-text":"返回","left-arrow":""},on:{"click-left":e.goback}},[n("van-icon",{attrs:{slot:"right",name:"add-o",size:"18px"},on:{click:function(t){e.addPopup=!0}},slot:"right"})],1),n("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:function(e){}},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.msgs,function(t){return n("van-swipe-cell",{attrs:{"right-width":65}},[n("van-cell-group",[n("van-cell",{attrs:{value:e.getContentTypeDesc(t.type),icon:"clock-o"},on:{click:function(n){return e.showContent(t)}}},[n("template",{slot:"title"},[n("span",{staticClass:"custom-text timer_type_desc"},[e._v(e._s(e.getTimerTypeDesc(t.schedule)))]),n("span",{staticClass:"custom-text",staticStyle:{"white-space":"nowrap"}},[e._v("["+e._s(e.formatTime(t.schedule))+"]")])])],2)],1),n("span",{attrs:{slot:"right"},on:{click:function(n){return e.delDialog(t.uuid)}},slot:"right"},[e._v("删除")])],1)}),1),n("van-popup",{staticStyle:{width:"100%",height:"100%"},attrs:{position:"right",overlay:!1},model:{value:e.addPopup,callback:function(t){e.addPopup=t},expression:"addPopup"}},[n("van-nav-bar",{attrs:{title:"添加全群定时消息","left-text":"返回","left-arrow":""},on:{"click-left":function(t){e.addPopup=!1}}}),n("van-radio-group",{model:{value:e.timeRadio,callback:function(t){e.timeRadio=t},expression:"timeRadio"}},[n("van-cell-group",{attrs:{title:"时间类型"}},[n("van-cell",{attrs:{title:"间隔时间",clickable:""},on:{click:function(t){e.timeRadio="1"}}},[n("van-radio",{attrs:{name:"1"}})],1),n("van-cell",{attrs:{title:"固定时间",clickable:""},on:{click:function(t){e.timeRadio="2"}}},[n("van-radio",{attrs:{name:"2"}})],1)],1)],1),n("van-cell-group",{directives:[{name:"show",rawName:"v-show",value:"1"==e.timeRadio,expression:"timeRadio=='1'"}]},[n("van-field",{attrs:{label:"间隔时间","left-icon":"clock-o",readonly:"readonly",clearable:"",placeholder:"请输入时间数值，单位：秒"},on:{focus:function(t){e.show=!0}},model:{value:e.schedule.ss,callback:function(t){e.$set(e.schedule,"ss",t)},expression:"schedule.ss"}}),n("p",{staticClass:"timer_desc"},[e._v("\r\n            频率每隔：["+e._s(parseInt(e.schedule.ss/60/60%60)+"小时"+parseInt(e.schedule.ss/60%60)+"分钟"+parseInt(e.schedule.ss%60)+"秒")+"]  发送一次\r\n            ")])],1),n("van-cell-group",{directives:[{name:"show",rawName:"v-show",value:"2"==e.timeRadio,expression:"timeRadio=='2'"}]},[n("span",{staticClass:"timer_desc"},[e._v("\r\n                    每当时间到达：[\r\n                "),n("span",{directives:[{name:"show",rawName:"v-show",value:null!=e.schedule.MM,expression:"schedule.MM != null"}]},[e._v(e._s(e.schedule.MM)+"月")]),n("span",{directives:[{name:"show",rawName:"v-show",value:null!=e.schedule.dd,expression:"schedule.dd != null"}]},[e._v(e._s(e.schedule.dd)+"日")]),n("span",{directives:[{name:"show",rawName:"v-show",value:null!=e.schedule.HH,expression:"schedule.HH != null"}]},[e._v(e._s(e.schedule.HH)+"时")]),n("span",{directives:[{name:"show",rawName:"v-show",value:null!=e.schedule.mm,expression:"schedule.mm != null"}]},[e._v(e._s(e.schedule.mm)+"分")]),n("span",{directives:[{name:"show",rawName:"v-show",value:""!=e.schedule.ss,expression:"schedule.ss != ''"}]},[e._v(e._s(e.schedule.ss)+"秒")]),e._v("] 发送一次\r\n            ")]),n("p",{staticClass:"p_timer_desc"},[e._v('"*" 号为该区域内所有时间段，例："14时5分*秒" 在下午2点5分 每秒发送一次')])]),n("van-radio-group",{model:{value:e.contentRadio,callback:function(t){e.contentRadio=t},expression:"contentRadio"}},[n("van-cell-group",{attrs:{title:"消息内容"}},[n("van-cell",{attrs:{title:"文本",clickable:""},on:{click:function(t){e.contentRadio="1"}}},[n("van-radio",{attrs:{name:"1"}})],1),n("van-cell",{attrs:{title:"文件",clickable:""},on:{click:function(t){e.contentRadio="2"}}},[n("van-radio",{attrs:{name:"2"}})],1)],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"1"==e.contentRadio,expression:"contentRadio=='1'"}],staticStyle:{"margin-bottom":"10px","max-height":"600px",overflow:"hidden"}},[n("van-field",{attrs:{type:"textarea",autosize:{maxHeight:200,minHeight:150},clearable:"",placeholder:"请输入内容..."},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"2"==e.contentRadio,expression:"contentRadio=='2'"}],staticClass:"uploader",attrs:{onclick:"document.getElementById('hiddenFile').click();"}},[n("div",{staticClass:"ivu-icon"},[n("van-icon",{attrs:{name:"upgrade"}}),n("input",{ref:"uploader",staticStyle:{display:"none"},attrs:{multiple:"multiple",type:"file",id:"hiddenFile"},on:{change:e.onRead}})],1),n("p",{staticStyle:{color:"rgb(51, 153, 255)"}},[e._v("点击上传文件")])]),e.imageVal&&"2"==e.contentRadio?n("div",{on:{click:e.showImg}},[n("van-icon",{staticClass:"img_icon",attrs:{name:"photo-o",size:"35px"}}),n("span",{staticClass:"custom-text",staticStyle:{display:"inline-block","padding-left":"5px"}},[e._v("\r\n                点击查看图片详情\r\n            ")])],1):"2"==e.contentRadio?n("span",{staticClass:"custom-text file_txt"},[e._v(e._s(e.contentFileName))]):e._e(),n("van-button",{attrs:{size:"large",type:"info",loading:e.loading},on:{click:e.addGlobalTimerMsg}},[e._v("\r\n            确定提交\r\n        ")]),n("van-popup",{attrs:{position:"bottom"},model:{value:e.pickerPopup,callback:function(t){e.pickerPopup=t},expression:"pickerPopup"}},[n("van-picker",{attrs:{"show-toolbar":"",title:"选择时间",columns:e.columns},on:{change:e.onChange,cancel:function(t){e.pickerPopup=!1},confirm:function(t){e.pickerPopup=!1}}})],1),n("van-number-keyboard",{attrs:{show:e.show,theme:"custom","close-button-text":"完成"},on:{blur:function(t){e.show=!1},input:e.onInput,delete:e.onDelete}})],1),n("van-dialog",{attrs:{"show-cancel-button":"",beforeClose:e.beforeClose},model:{value:e.isShow,callback:function(t){e.isShow=t},expression:"isShow"}},[n("div",{staticClass:"van-dialog__content"},[n("div",{staticClass:"van-dialog__message"},[e._v("确定删除吗？")])])]),n("footerNav")],1)},a=[],i=(n("ac6a"),n("a4bb")),o=n.n(i),l=(n("386d"),n("7f7f"),n("28a5"),n("e814")),c=n.n(l),r=n("dc5d"),u=n("5b59"),d=n("b970"),h=n("c276"),p=["*"],f=["*"],v=["*"],m=["*"],g=["*"],b=1;b<=12;b++)p.push(b);for(b=1;b<=31;b++)f.push(b);for(b=0;b<24;b++)v.push(b);for(b=0;b<60;b++)m.push(b);for(b=0;b<60;b++)g.push(b);var w={"月":p},k={"日":f},x={"时":v},_={"分":m},R={"秒":g},y={components:{topNav:r["a"],footerNav:u["a"]},data:function(){return{token:"",uuid:"",isShow:!1,addPopup:!1,loading:!1,finished:!0,msgs:[],columns:[{values:w["月"]},{values:k["日"]},{values:x["时"]},{values:_["分"]},{values:R["秒"]}],nowMM:"*",schedule:{MM:null,dd:null,HH:null,mm:null,ss:""},show:!1,timeRadio:"1",pickerPopup:!1,contentRadio:"1",content:null,contentFile:{},contentFileName:"",imageVal:null}},watch:{timeRadio:function(e){this.pickerPopup=2==e}},mounted:function(){this.token=Object(h["c"])(window.location.href).token_m,this.loadTimer()},methods:{showContent:function(e){var t="时间类型："+this.getTimerTypeDesc(e.schedule)+"\n时间设定："+this.formatTime(e.schedule)+"\n内容类型："+this.getContentTypeDesc(e.type)+"\n内容详情："+e.content;Object(d["e"])(t)},onChange:function(e,t,n){if(this.schedule.MM=t[0],this.schedule.dd=t[1],this.schedule.HH=t[2],this.schedule.mm=t[3],this.schedule.ss=t[4],0==n){var s=t[0];if(s==this.nowMM)return;this.nowMM=s;var a=["*"];if("*"==s)for(var i=1;i<=31;i++)a.push(i);else{var o=new Date(2019,c()(s),0).getDate();for(i=1;i<=o;i++)a.push(i)}k={"日":a};var l=[{values:w["月"]},{values:k["日"]},{values:x["时"]},{values:_["分"]},{values:R["秒"]}];this.columns=l}},onInput:function(e){this.schedule.ss=this.schedule.ss+""+e},onDelete:function(){this.schedule.ss=this.schedule.ss.substr(0,this.schedule.ss.length-1)},goback:function(){this.$router.go(-1)},getContentTypeDesc:function(e){return Object(h["b"])(e)},formatTime:function(e){var t=e.split("|"),n=t[0];if("1"==n){var s=t[1].split(",");return s[0]+"月"+s[1]+"日"+s[2]+"点"+s[3]+"分"+s[4]+"秒"}return c()(c()(t[1])/60/60%60)+"小时"+c()(c()(t[1])/60%60)+"分钟"+c()(c()(t[1])%60)+"秒"},getTimerTypeDesc:function(e){var t=e.split("|"),n=t[0];return"1"==n?"定时":"间隔"},showImg:function(){Object(d["b"])([""+this.imageVal])},onRead:function(e){var t=this.$refs.uploader,n=t.files[0];if(void 0!=n){this.imageVal=null;var s=Math.floor(n.size/1024);if(s>81920)return Object(d["e"])("请选择80M以内的文件！"),!1;if(this.contentFile=n,this.content=n.name,this.contentFileName=n.name,-1!=n.type.search("image/")){var a=this;if(!e||!window.FileReader)return;var i=new FileReader;i.readAsDataURL(n),i.onloadend=function(){a.imageVal=this.result}}}},loadTimer:function(){var e=this;this.$config.globalTimer.length?this.msgs=this.$config.globalTimer:(d["e"].loading({forbidClick:!0,duration:0,message:"正在初始化..."}),this.$http.post("timer/getTimers?format=json",{token:this.token}).then(function(t){var n=t.data;console.log(n),n.result?d["e"].fail(n.msg):(o()(n.data).length>0&&(e.$config.globalTimer=e.msgs=n.data.info.global),setTimeout(function(){Object(d["e"])("加载全域定时消息设置成功")},500))}).catch(function(e){console.log(e)}))},delDialog:function(e){this.uuid=e,this.isShow=!0},beforeClose:function(e,t){var n=this;if("cancel"==e&&t(),"confirm"==e){var s={seq:"global",uuid:this.uuid,token:this.token};this.$http.post("timer/delMsg?format=json",s).then(function(e){t(),Object(d["e"])(e.data.msg),n.msgs=n.msgs.filter(function(e){return e.uuid!=n.uuid}),n.$config.globalTimer=n.msgs}).catch(function(e){console.log(e)})}},addGlobalTimerMsg:function(){var e=this,t=new FormData;t.append("token",this.token),t.append("seq","global"),t.append("content","1"==this.contentRadio?this.content:this.contentFile);var n=[];if("2"==this.timeRadio){if(o()(this.schedule).forEach(function(t){n.push(e.schedule[t])}),n="1|"+n.join(","),-1!=n.indexOf(",,"))return void Object(d["e"])("时间信息不完整!")}else{if(""==this.schedule.ss)return void Object(d["e"])("时间信息不完整");n="2|"+this.schedule.ss}t.append("schedule",n),this.loading=!0,this.$http.post("timer/addMsg?format=json",t).then(function(t){var n=t.data;n.result?(e.loading=!1,d["e"].fail(n.msg)):(e.msgs.push(n.data.info),e.$config.globalTimer=e.msgs,e.loading=!1,d["e"].success(n.msg),setTimeout(function(){e.addPopup=!1},500))}).catch(function(t){e.loading=!1,console.log(t)})}}},T=y,C=(n("6b5f"),n("2877")),M=Object(C["a"])(T,s,a,!1,null,null,null);t["default"]=M.exports},ce7e:function(e,t,n){var s=n("63b6"),a=n("584a"),i=n("294c");e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],o={};o[e]=t(n),s(s.S+s.F*i(function(){n(1)}),"Object",o)}},dc5d:function(e,t,n){"use strict";var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("van-nav-bar",{attrs:{title:e.$route.meta.title,"left-text":"返回","left-arrow":""},on:{"click-left":e.goback}})},a=[],i={name:"topNav",data:function(){return{}},methods:{goback:function(){this.$router.go(-1)}}},o=i,l=n("2877"),c=Object(l["a"])(o,s,a,!1,null,"2fe8c154",null);t["a"]=c.exports}}]);
//# sourceMappingURL=chunk-be45098a.f48e381e.js.map